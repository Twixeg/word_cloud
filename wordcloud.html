<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Облако слов</title>
    <style>
        body { font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 0; background-color: #f0f2f5; }
        .container { background: white; padding: 2em; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center; }
        #wordcloud { width: 100%; height: 500px; }
        a { margin-top: 20px; color: #007BFF; text-decoration: none; }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/wordcloud2@1.2.2/wordcloud2.js"></script>
</head>
<body>
    <div class="container">
        <h1>Облако слов</h1>
        <div id="wordcloud-container" style="width: 600px; height: 400px;">
            <canvas id="wordcloud-canvas" style="width: 100%; height: 100%;"></canvas>
        </div>
        <a href="index.html">Вернуться к форме</a>
    </div>

    <script>
        function createWordCloud() {
            const answers = JSON.parse(localStorage.getItem('answers') || '[]');
            const wordCounts = {};

            // Список стоп-слов для русского языка. Можно дополнить.
            const stopWords = new Set([
                'и', 'в', 'на', 'а', 'что', 'он', 'она', 'они', 'мы', 'ты', 'я', 'но', 'да', 'как', 'о', 'с', 'к', 'по', 'из', 'для', 'это', 'не', 'бы', 'же', 'то'
            ]);

            answers.forEach(answer => {
                const words = answer.toLowerCase().replace(/[.,!?;:()]/g, '').split(/\s+/);
                words.forEach(word => {
                    if (word && !stopWords.has(word)) {
                        wordCounts[word] = (wordCounts[word] || 0) + 1;
                    }
                });
            });

            const list = Object.keys(wordCounts).map(word => [word, wordCounts[word]]);

            if (list.length === 0) {
                const canvas = document.getElementById('wordcloud-canvas');
                const ctx = canvas.getContext('2d');
                ctx.font = '20px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Пока нет данных для облака.', canvas.width / 2, canvas.height / 2);
            } else {
                WordCloud(document.getElementById('wordcloud-canvas'), {
                    list: list,
                    gridSize: 10,
                    weightFactor: 5,
                    fontFamily: 'sans-serif',
                    minSize: 10
                });
            }
        }

        createWordCloud();
    </script>
</body>
</html>
